---
output:
  word_document: default
  pdf_document: default
params:
  station: "Fermar Seafoods CC (109)"
---

### REPUBLIC OF NAMIBIA

### MINISTRY OF FISHERIES AND MARINE RESOURCES


Directorate of Aquaculture

Enquiries: H. Skrypzeck

Tel: (+264 64) 4101000

Fax: (+264 64) 404385

P O Box 912

Swakopmund

Namibia

## Namibian Shellfish Sanitation and BiotoxinMonitoring Program

### `r params$station`

### Oxygen Report

```{r message=FALSE, echo=FALSE, warning= FALSE}
library(readr)
library(readxl)
library(ggplot2)
library(dplyr)
library(kableExtra)
```



```{r echo=FALSE, message=FALSE}
plot_data <- read_excel("Qry_Dissolved O2.xlsx") |>
  mutate(do_mg_l = DissolvedO2/0.7) |>
  group_by(`Sampling Date`, Station, Depth) |>
  summarise(do_mg_l = mean(do_mg_l)) |>
  filter(Station == params$station)
```


```{r echo=FALSE}
kable(plot_data)
```



```{r echo=FALSE, message=FALSE, fig.cap="Depth vs Disslved O2", fig.width=8}
ggplot(plot_data, aes(x = do_mg_l, y = Depth)) +
  geom_point(color = "blue", size = 3) +
  geom_path(color = "red", linewidth = 0.7) +  # Connect points
  labs(title = "Dissolved O2 Profile by Depth",
       x = "Dissolved Oxygen mg/l",
       y = "Depth") +
  scale_y_reverse(breaks = seq(0, max(plot_data$Depth), by = 1)) +# Makes depth increase downward
  scale_x_continuous(limits = c(floor(min(plot_data$do_mg_l)), ceiling(max(plot_data$do_mg_l))), 
                     breaks = seq(floor(min(plot_data$do_mg_l)), ceiling(max(plot_data$do_mg_l)), by = 0.5), 
                     position = "top") + # (position = "top") change of y axis to top
  theme_classic() +
  theme(plot.title = element_text(hjust = 0.5))
```

