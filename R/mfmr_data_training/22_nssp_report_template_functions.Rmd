---
title: 
output: word_document
---


```{r include = FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, fig.id="pressure")
```

```{r  message=FALSE, echo=FALSE}
source("../setup.R")
```

```{r, echo=FALSE, fig.align='center', out.width="50%", height="50%"}
# adds coat of arms to report
include_graphics(path = "../data/coat of Arms JPG.jpg")
```

# THE NAMIBIAN SHELLFISH SANITATION PROGRAMME (NSSP) REVIEW REPORT FOR 2024/25

```{r message=FALSE, echo=FALSE}
x <- read_phyto_data()
```

```{r warning=FALSE, echo=FALSE}
y <- read_toxin_data()
```

```{r message=FALSE, echo=FALSE}
# make a new table format to use for the figures
```

```{r echo=FALSE}
# assign each year to a custom color palette
# found the answer here: https://stackoverflow.com/questions/6919025/how-to-assign-colors-to-categorical-variables-in-ggplot2-that-have-stable-mappin
library(RColorBrewer)
years <- unique(x$year)
myColors <- brewer.pal(length(years),"Spectral")
names(myColors) <- years
```


# BIOTOXINS AND HABs PHYTOPLANKTON

Harmful algal blooms (HABs), caused by toxin-producing phytoplankton, represent a growing threat to seafood safety in Namibia. These blooms compromise both public health and the sustainability of the country's shellfish industry, particularly in coastal regions such as Walvis Bay and Lüderitz. HABs form when specific phytoplankton species proliferate under favorable environmental conditions, leading to the production of potent marine biotoxins. These toxins can bioaccumulate in the tissues of shellfish and some non-filter feeding organisms, posing a risk to human health when consumed. The illnesses commonly associated with such toxins include paralytic (PSP), diarrhetic (DSP), amnesic (ASP), and neurotoxic (NSP) shellfish poisoning, caused by exposure to paralytic shellfish toxins (PST), diarrhetic/lipophilic shellfish toxins (DST/LST), amnesic shellfish toxins (AST), and brevetoxins, respectively.

The Namibian Shellfish Sanitation Programme (NSSP) has identified several harmful phytoplankton species and their associated toxins, reinforcing the need for integrated phytoplankton and biotoxin surveillance to ensure the safe management of shellfish harvesting areas. Recent efforts are focused on developing an early warning system for HABs, combining scientific monitoring and mitigation strategies to safeguard public health and maintain confidence in Namibian seafood exports.

## AST and *Pseudo-nitzschia sp.*

The Codex limits for AST 20 mg kg-1. The limit of detection is 1.0 mg kg-1 and the limit of quantification is 1.5 mg kg-1.

```{r message=FALSE, echo=FALSE}
# find the site-specific annual monthly mean for each of the pseudo-nitzschia groups counted
pn_monthly_mean <- get_monthly_stats(x, group="ast")
```



### Aquapark 1 (PA WB1) for oysters

```{r message=FALSE, echo=FALSE, fig.cap="Pseudo-nitzschia sp. Average cells/L/month in Aquapark 1 for 2018-2024", fig.width=8}
plot_phyto_barplot(pn_monthly_mean, colors=myColors, subregion = "wb1")
```


### Aquapark 4 (PA WB4) for oysters

```{r message=FALSE, echo=FALSE, fig.cap="Pseudo-nitzschia sp. Average cells/L/month in Aquapark 4 (pond 1) for 2018-2024", fig.width=8}
plot_phyto_barplot(pn_monthly_mean, colors=myColors, subregion = "wb4_pond1")
```


```{r message=FALSE, echo=FALSE, fig.cap="Pseudo-nitzschia sp. Average cells/L/month in Aquapark 4 (pond 2) for 2018-2024", fig.width=8}
plot_phyto_barplot(pn_monthly_mean, colors=myColors, subregion = "wb4_pond2")
```


### Lüderitz second lagoon (PA L2) for oysters

```{r message=FALSE, echo=FALSE, fig.cap="Pseudo-nitzschia sp. Average cells/L/month in Luderitz for 2018-2024", fig.width=8}
plot_phyto_barplot(pn_monthly_mean, colors=myColors, subregion = "l2")
```

### Lüderitz (PA L1) for abalone

```{r message=FALSE, echo=FALSE, fig.cap="Pseudo-nitzschia spp. cells-L (>0) – causative species for lipophillics at Luderitz abalone sites", fig.width=8}
plot_phyto_barplot(pn_monthly_mean, colors=myColors, subregion = "l1")
```

## Lipophilic toxins (or DST) and *Dinophysis* spp

The LC-MS/MS method is a quantitative analytical technique, with the limits of detection (LOD) and limits of quantification (LOQ) provided in Annexure F. According to Codex standards, the maximum allowable limit for total OA group toxins is 0.16 mg/kg. The maximum permissible level for total Yessotoxin group toxins is ≤3.75 mg/kg of edible flesh in the European Union, and ≤8 mg/kg of edible flesh in South Africa. Prorocentrum lima is one of the known causative species of Diarrhetic Shellfish Toxins (DST). However, it is easily confused with Prorocentrum fukuyoi. Based on recent assessments, it has been confirmed that all cells observed since 2022 are not Prorocentrum lima.

```{r message=FALSE, echo=FALSE}
# find the site-specific annual monthly mean for each of the dinophysis groups counted
dn_monthly_mean <- get_monthly_stats(x, group = "dst")
```

### Aquapark 1 (PA WB1) for oysters

```{r message=FALSE, echo=FALSE, fig.cap="Dinophysis sp. Average cells/L/month in Aquapark 1 for 2018-2024", fig.width=8}
plot_phyto_barplot(dn_monthly_mean, colors=myColors, subregion="wb1")
```


```{r warning=FALSE, echo=FALSE, fig.cap="Total Okadaic Acid Group test results in oysters for Aquapark 1. The Codex limit is 0.16 mg/kg."}
plot_okadaic(y, subregion="wb1")
```


```{r warning=FALSE, echo=FALSE, fig.cap="Total Yessotoxin (YTX) Group toxins in oysters from Aquapark 1."}
plot_yessotoxin(y, subregion = "wb1")
```

### Aquapark 4 (PA WB4) for oysters

```{r message=FALSE, echo=FALSE, fig.cap="Dinophysis sp. Average cells/L/month in Aquapark 4 (pond 1) for 2018-2024", fig.width=8}
plot_phyto_barplot(dn_monthly_mean, colors=myColors, subregion="wb4_pond1")
```

```{r message=FALSE, echo=FALSE, fig.cap="Mean Dinophysis spp cells/L in Aquapark 4 (pond 2) for 2018-2024", fig.width=8}
plot_phyto_barplot(dn_monthly_mean, colors=myColors, subregion="wb4_pond2")
```


```{r warning=FALSE, echo=FALSE, fig.cap="Total Okadaic Acid Group test results in oysters for Aquapark 4. The Codex limit is 0.16 mg/kg."}
plot_okadaic(y, subregion=c("wb4_pond1", "wb4_pond2"))
```


```{r warning=FALSE, echo=FALSE, fig.cap="Total Yessotoxin (YTX) Group toxins in oysters from Aquapark 4."}
plot_yessotoxin(y, subregion = c("wb4_pond1", "wb4_pond2"))
```


### Lüderitz second lagoon (PA L2) for oysters


```{r message=FALSE, echo=FALSE, fig.cap="Dinophysis sp. Average cells/L/month in Luderitz for 2018-2024", fig.width=8}
plot_phyto_barplot(dn_monthly_mean, colors=myColors, subregion="l2")
```



```{r message=FALSE, echo=FALSE, fig.cap="Dinophysis spp. cells-L – causative species for lipophillics at Luderitz oyster sites", fig.width=8}
plot_phyto_scatter(x, subregion="l2", group="dst")
```

```{r warning=FALSE, echo=FALSE, fig.cap="Total Okadaic Acid Group test results in oysters for Lüderitz second lagoon. The Codex limit is 0.16 mg/kg."}
plot_okadaic(y, subregion=c("l2"))
```


```{r warning=FALSE, echo=FALSE, fig.cap="Total Yessotoxin (YTX) Group toxins in oysters from Lüderitz second lagoon."}
plot_yessotoxin(y, subregion = c("l2"))
```

###	Lüderitz (PA L1) for abalone 

```{r message=FALSE, echo=FALSE, fig.cap="Dinophysis spp. cells-L (>0) – causative species for lipophillics at Luderitz abalone sites", fig.width=8}
plot_phyto_barplot(dn_monthly_mean, colors=myColors, subregion="l1")
```


```{r warning=FALSE, echo=FALSE, fig.cap="Total Okadaic Acid Group test results in abalone for Lüderitz. The Codex limit is 0.16 mg/kg."}
plot_okadaic(y, subregion=c("l1"))
```


## PSTs and *Alexandrium* spp

The Codex limit for PST is 0.8 mg kg-1. The limit of detection is undetermined and the limit of quantification is 0.50 STX mg kg-1.

```{r message=FALSE, echo=FALSE}
# find the site-specific annual monthly mean for each of the alexandrium groups counted
al_monthly_mean <- get_monthly_stats(x, group="pst")
```


### Aquapark 1 (PA WB1) for oysters

```{r message=FALSE, echo=FALSE, fig.cap="Alexandrium sp. Average cells/L/month in Aquapark 1 for 2018-2024", fig.width=8}
plot_phyto_barplot(al_monthly_mean, colors=myColors, subregion="wb1")
```

```{r}
plot_phyto_heatmap(al_monthly_mean, subregion="wb1", group="pst")
```


```{r warning=FALSE, echo=FALSE, fig.cap="PST tests for oysters for Aquapark 1. Red line represents the Codex limit."}
filter(y, Station %in% c("Fermar Seafoods CC (109)", "NamOysters cc Aquapark 1 (101)")) |>
  ggplot(aes(x = `Sampling Date`, y = `PSP Value`)) +
  geom_point(color="blue") +
  geom_hline(yintercept = 80, color="red") +
  theme_classic() +
  labs(x=NULL, y="PST value ug STX eq/100g") 
```


```{r fig.cap="PST tests in abalone at Aquapark 1 Red line represents the Codex limit."}
plot_saxitoxin(y, subregion = "wb1")
```

### Aquapark 4 (PA WB4) for oysters

Pond 1

```{r message=FALSE, echo=FALSE, fig.cap="Alexandrium sp. Average cells/L/month in Aquapark 4 for 2018-2024", fig.width=8}
plot_phyto_barplot(al_monthly_mean, colors=myColors, subregion="wb4_pond1")
```

Pond 2

```{r message=FALSE, echo=FALSE, fig.cap="Alexandrium sp. Average cells/L/month in Aquapark 4 (pond 2) for 2018-2024", fig.width=8}
plot_phyto_barplot(al_monthly_mean, colors=myColors, subregion="wb4_pond2")
```

```{r warning=FALSE, echo=FALSE, fig.cap="PST tests for oysters for Aquapark 1. Red line represents the Codex limit."}
filter(y, Station %in% c("Aquapark 4 (112)", "Nam Oysters SALT PANS (115)")) |>
  ggplot(aes(x = `Sampling Date`, y = `PSP Value`)) +
  geom_point(aes(shape = Station, color=Station)) +
  geom_hline(yintercept = 80, color="red") +
  theme_classic() +
  labs(x=NULL, y="PST value ug STX eq/100g") + 
  theme(legend.position = "bottom")
```

### Lüderitz second lagoon (PA L2) for oysters


```{r message=FALSE, echo=FALSE, fig.cap="Alexandrium sp. Average cells/L/month in Luderitz for 2018-2024", fig.width=8}
plot_phyto_barplot(al_monthly_mean, colors=myColors, subregion="l2")
```

```{r fig.cap="Alexandrium spp. cells-L (>0) – causative species for PSTs at Luderitz oyster sites", fig.width=8}
plot_phyto_scatter(x, group = "pst", subregion = "l2")
```


```{r fig.cap="PST tests in oysters at Lüderitz. Red line represents the Codex limit."}
plot_saxitoxin(y, subregion = "l2")
```

### Lüderitz (PA L1) for abalone

```{r message=FALSE, echo=FALSE, fig.cap="Alexandrium spp. cells-L (>0) – causative species for PSTs at Luderitz abalone sites", fig.width=8}
plot_phyto_barplot(al_monthly_mean, colors=myColors, subregion="l1")
```


```{r fig.cap="PST tests in abalone at Lüderitz. Red line represents the Codex limit."}
plot_saxitoxin(y, subregion = "l1")
```

